var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function r(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function c(t){return null==t?"":t}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function $(t){return document.createTextNode(t)}function h(){return $(" ")}function m(){return $("")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t){return""===t?null:+t}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}let y;function b(t){y=t}function k(){if(!y)throw new Error("Function called outside component initialization");return y}function D(t){k().$$.on_mount.push(t)}function N(){const t=k();return(e,n,{cancelable:o=!1}={})=>{const l=t.$$.callbacks[e];if(l){const i=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const l=document.createEvent("CustomEvent");return l.initCustomEvent(t,n,o,e),l}(e,n,{cancelable:o});return l.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}function T(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const j=[],S=[],I=[],A=[],C=Promise.resolve();let O=!1;function z(t){I.push(t)}function E(t){A.push(t)}const F=new Set;let Y=0;function _(){const t=y;do{for(;Y<j.length;){const t=j[Y];Y++,b(t),P(t.$$)}for(b(null),j.length=0,Y=0;S.length;)S.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];F.has(e)||(F.add(e),e())}I.length=0}while(j.length);for(;A.length;)A.pop()();O=!1,F.clear(),b(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(z)}}const U=new Set;let q;function B(){q={r:0,c:[],p:q}}function Z(){q.r||o(q.c),q=q.p}function Q(t,e){t&&t.i&&(U.delete(t),t.i(e))}function H(t,e,n,o){if(t&&t.o){if(U.has(t))return;U.add(t),q.c.push((()=>{U.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function G(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function W(t){t&&t.c()}function J(t,n,i,s){const{fragment:r,on_mount:c,on_destroy:a,after_update:u}=t.$$;r&&r.m(n,i),s||z((()=>{const n=c.map(e).filter(l);a?a.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(z)}function R(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(j.push(t),O||(O=!0,C.then(_)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,l,i,s,r,c,a,u=[-1]){const p=y;b(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(p?p.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:l.target||p.$$.root};a&&a(f.root);let $=!1;if(f.ctx=i?i(e,l.props||{},((t,n,...o)=>{const l=o.length?o[0]:n;return f.ctx&&r(f.ctx[t],f.ctx[t]=l)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](l),$&&V(e,t)),n})):[],f.update(),$=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);f.fragment&&f.fragment.l(t),t.forEach(d)}else f.fragment&&f.fragment.c();l.intro&&Q(e.$$.fragment),J(e,l.target,l.anchor,l.customElement),_()}b(p)}class X{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var tt={getWalkingDirections:async(t,e)=>{const n=[t.lng,t.lat].join(","),o=[e.lng,e.lat].join(","),l=await(async(t,e)=>{const n=Object.assign({api_key:"5b3ce3597851110001cf6248511c38bca6e2470b828a93edf1d33fe6"},e),o=new URLSearchParams(n).toString();return await fetch(`https://api.openrouteservice.org${t}?${o}`)})("/v2/directions/foot-walking",{start:n,end:o});return await l.json()}};var et={load:t=>{if(!window.localStorage)return;const e=window.localStorage.getItem(t);return console.log("load",t,e),JSON.parse(e)},save:(t,e)=>{console.log("save",t,e),window.localStorage&&window.localStorage.setItem(t,JSON.stringify(e))}};const nt=[];function ot(e,n=t){let o;const l=new Set;function s(t){if(i(e,t)&&(e=t,o)){const t=!nt.length;for(const t of l)t[1](),nt.push(t,e);if(t){for(let t=0;t<nt.length;t+=2)nt[t][0](nt[t+1]);nt.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(i,r=t){const c=[i,r];return l.add(c),1===l.size&&(o=n(s)||t),i(e),()=>{l.delete(c),0===l.size&&(o(),o=null)}}}}const lt=ot({lat:51.44335302653705,lng:-.27522446597719047}),it=ot([]),st=ot(!0),rt=t=>{let e=t[0][0],n=t[0][1],o=t[0][0],l=t[0][1];return t.forEach((t=>{t[0]<e&&(e=t[0]),t[1]<n&&(n=t[1]),t[0]>o&&(o=t[0]),t[1]>l&&(l=t[1])})),[[e,n],[o,l]]};var ct={getMarkerBoundingBox:t=>{const e=[];return Object.entries(t).forEach((([t,n])=>{e.push([n.getLatLng().lat,n.getLatLng().lng])})),0===e.length?null:rt(e)},latLonBoundingBox:rt};const{getMarkerBoundingBox:at,latLonBoundingBox:ut}=ct;class dt{constructor(t=null){this.markerData={},this.leafletMarkers=[],this.polyLines=[],this.houseIconData="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzUycHQiIGhlaWdodD0iNzUycHQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDc1MiA3NTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8cGF0aCBkPSJtMzc1IDE0OC4zOWMtNC40NTcgMC04LjkxNDEgMS40OTYxLTEyLjU2NiA0LjQ5MjJsLTIxMC44NyAxNzNjLTYuNDgwNSA1LjMyMDMtOC45MTQxIDE0LjE0MS02LjA3MDMgMjIuMDI3IDIuODMyIDcuODYzMyAxMC4yODUgMTMuMDk4IDE4LjYzNyAxMy4wOThoMC4wODU5MzhsMzguNzA3LTAuMTcxODh2MC4wMDM5MDZsMC4xNDA2MiAyMTIuODljMC4wMDM5MDYgNS4yNTc4IDIuMDk3NyAxMC4zMDEgNS44MTY0IDE0LjAxMiAzLjcxNDggMy43MDcgOC43NDYxIDUuNzg1MiAxMy45OTIgNS43ODUyaDAuMDM1MTU2bDk4LjU4Ni0wLjE3MTg4aDAuMDI3MzQ0Yy0wLjExNzE5LTAuODAwNzgtMC4xNzU3OC0xLjYxMzMtMC4xNzU3OC0yLjQyOTd2LTE2MS4yMWMwLTQuNDQxNCAxLjc2NTYtOC43MDcgNC45MDYyLTExLjg0OCAzLjE0MDYtMy4xNDA2IDcuNDAyMy00LjkwNjIgMTEuODQ4LTQuOTA2Mmw3My40MTQgMC4wMDc4MTJjOS4yNTM5IDAgMTYuNzU0IDcuNSAxNi43NTQgMTYuNzU0djE2MS4yYzAgMC45Mjk2OS0wLjA3NDIxOSAxLjgzOTgtMC4yMjI2NiAyLjcyNjZoMC4wMjczNDRsNTYuODI4IDAuMzA0NjloMC4xMDkzOGMwLjg2NzE5IDAgMS43MjI3LTAuMDU0Njg4IDIuNTYyNS0wLjE2NDA2aDAuMDA3ODEyYzAuMDg5ODQ0IDAuMDAzOTA2IDAuMTc5NjkgMC4wMDM5MDYgMC4yNzM0NCAwLjAwMzkwNmwzOC42NTIgMC4wMTU2MjZoMC4wMDc4MTNjMTAuOTIyIDAgMTkuNzg1LTguODQzOCAxOS44MDktMTkuNzY2bDAuNDkyMTktMjEyLjk2IDM4Ljc1LTAuMTMyODFjOC4zNTE2LTAuMDMxMjUgMTUuNzg5LTUuMjk2OSAxOC41OTQtMTMuMTY0IDIuODAwOC03Ljg2NzIgMC4zNjcxOS0xNi42NDgtNi4wODU5LTIxLjk1M2wtMjEwLjUtMTcyLjkzYy0zLjY1NjItMy04LjExNzItNC41LTEyLjU3NC00LjV6IiBmaWxsPSIjMDA0NDllIi8+Cjwvc3ZnPgo=",this.longPressTimeMs=500,this.options=null!=t?t:null}option(t){return Object.keys(this.options).includes(t)?this.options[t]:null}setLeaflet(t){return this.leaflet=t,this}createMap(t,e){return this.map=this.leaflet.map(t,e),this.option("startLocation")&&this.map.setView(this.option("startLocation"),18),this.leaflet.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:this.option("mapBox").accessToken}).addTo(this.map),this.map}fitCoords(t){const e=ut(t);this.map.flyToBounds(e,{maxZoom:17})}fitBoundsToAllMarkers(){const t=at(this.markerData);t&&this.map.flyToBounds(t)}flyTo(t){this.map.flyTo([t.lat,t.lng],17)}clearLines(){this.polyLines.forEach((t=>{t.remove()}))}drawLine(t){const e=this.leaflet.polyline(t,{color:"red"}).addTo(this.map);this.polyLines.push(e)}drawMarkers(t){const e=Object.keys(this.markerData);t.forEach((t=>{const n=`${t.location.lat}-${t.location.lng}`;if(e.includes(n)){const t=e.findIndex((t=>t===n));t>-1&&e.splice(t,1)}else this.markerData[n]=this.leaflet.marker(t.location),this.markerData[n].addTo(this.map),this.markerData[n].on("click",this.markerClickHandler)})),e.forEach((t=>{this.markerData[t].removeFrom(this.map),delete this.markerData[t]}))}drawHouse(t){this.homeLocationMarker&&this.homeLocationMarker.removeFrom(this.map);const e=this.leaflet.icon({iconUrl:this.houseIconData,iconSize:[50,50],iconAnchor:[25,50]}),n=this.leaflet.marker(t,{icon:e}).addTo(this.map);this.homeLocationMarker=n}onMarkerClick(t){this.markerClickHandler=t}onClick(t){this.map.on("click",t)}onLongClick(t){this.map.on("mousedown",(e=>{this.mouseDownTimeout=setTimeout((()=>{t(e)}),this.longPressTimeMs)})),this.map.on("mouseup",(t=>{clearTimeout(this.mouseDownTimeout)})),this.map.on("mousemove",(t=>{clearTimeout(this.mouseDownTimeout)}))}addStore(t,e,n,o=null){return it.update((l=>{const i={price:t,name:e,location:n};return o&&(i.description=o),[...l,i]})),this}initMap(){}}function pt(e){let n;return{c(){n=f("div"),v(n,"id","map"),v(n,"class","svelte-kr17y5")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function ft(t,e,n){const o=N();let l;return D((()=>{l=new dt({debug:!0,startLocation:[51.46521575117327,-.2595353314797258],mapBox:{accessToken:"pk.eyJ1IjoiZnVuYW5kY29vbGd1eSIsImEiOiJjbDJyYWh2ZzYzMXNoM2lwOWhudGQ1NGpnIn0.PG_RcxkH973h1MEirqweDg"}}),l.setLeaflet(void 0===L?void 0:L),l.createMap("map"),it.subscribe((t=>{l.drawMarkers(t),l.fitBoundsToAllMarkers()})),lt.subscribe((t=>{l.drawHouse(t)})),l.onMarkerClick((t=>{o("markerClick",t)})),l.onClick((t=>{o("mapClick",t)})),l.onLongClick((t=>{o("mapLongPress",t)}))})),[t=>{void 0!==l&&l.flyTo(t)},t=>{void 0!==l&&(l.clearLines(),l.drawLine(t),l.fitCoords(t))}]}class $t extends X{constructor(t){super(),K(this,t,ft,pt,i,{flyTo:0,drawRoute:1})}get flyTo(){return this.$$.ctx[0]}get drawRoute(){return this.$$.ctx[1]}}var ht=(t,e)=>{let[n,o]=t,[l,i]=e;o=o*Math.PI/180,i=i*Math.PI/180,n=n*Math.PI/180,l=l*Math.PI/180;let s=i-o,r=l-n,c=Math.pow(Math.sin(r/2),2)+Math.cos(n)*Math.cos(l)*Math.pow(Math.sin(s/2),2);return 6371*(2*Math.asin(Math.sqrt(c)))};function mt(e){let n,o,l,i,s,r,c,p,m,M,x,y,b,k,D,N=e[0].name+"",T=e[1].toFixed(2)+"",L=e[0].price.toFixed(2)+"";return{c(){n=f("div"),o=f("div"),l=f("div"),i=$(N),s=h(),r=f("div"),c=$(T),p=$("km"),m=h(),M=f("div"),x=$("£"),y=$(L),v(l,"class","title svelte-1clp0r6"),v(r,"class","distance svelte-1clp0r6"),v(o,"class","left svelte-1clp0r6"),v(M,"class","right svelte-1clp0r6"),v(n,"class","shop-card svelte-1clp0r6"),v(n,"title",b=e[0].description)},m(t,d){u(t,n,d),a(n,o),a(o,l),a(l,i),a(o,s),a(o,r),a(r,c),a(r,p),a(n,m),a(n,M),a(M,x),a(M,y),k||(D=g(n,"click",e[2]),k=!0)},p(t,[e]){1&e&&N!==(N=t[0].name+"")&&w(i,N),2&e&&T!==(T=t[1].toFixed(2)+"")&&w(c,T),1&e&&L!==(L=t[0].price.toFixed(2)+"")&&w(y,L),1&e&&b!==(b=t[0].description)&&v(n,"title",b)},i:t,o:t,d(t){t&&d(n),k=!1,D()}}}function gt(t,e,n){let o,l;s(t,lt,(t=>n(3,l=t)));const i=N();let{shop:r}=e;return t.$$set=t=>{"shop"in t&&n(0,r=t.shop)},t.$$.update=()=>{9&t.$$.dirty&&n(1,o=ht([l.lat,l.lng],[r.location.lat,r.location.lng]))},[r,o,t=>{i("shopClick",r)},l]}class vt extends X{constructor(t){super(),K(this,t,gt,mt,i,{shop:0})}}function Mt(t,e,n){const o=t.slice();return o[2]=e[n],o}function wt(t){let e,n;return e=new vt({props:{shop:t[2]}}),e.$on("shopClick",t[1]),{c(){W(e.$$.fragment)},m(t,o){J(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.shop=t[2]),e.$set(o)},i(t){n||(Q(e.$$.fragment,t),n=!0)},o(t){H(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function xt(t){let e,n,o=t[0],l=[];for(let e=0;e<o.length;e+=1)l[e]=wt(Mt(t,o,e));const i=t=>H(l[t],1,1,(()=>{l[t]=null}));return{c(){e=f("div");for(let t=0;t<l.length;t+=1)l[t].c();v(e,"class","container svelte-a5c4d2")},m(t,o){u(t,e,o);for(let t=0;t<l.length;t+=1)l[t].m(e,null);n=!0},p(t,[n]){if(1&n){let s;for(o=t[0],s=0;s<o.length;s+=1){const i=Mt(t,o,s);l[s]?(l[s].p(i,n),Q(l[s],1)):(l[s]=wt(i),l[s].c(),Q(l[s],1),l[s].m(e,null))}for(B(),s=o.length;s<l.length;s+=1)i(s);Z()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)Q(l[t]);n=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)H(l[t]);n=!1},d(t){t&&d(e),p(l,t)}}}function yt(t,e,n){let{shops:o}=e;return t.$$set=t=>{"shops"in t&&n(0,o=t.shops)},[o,function(e){T.call(this,t,e)}]}class bt extends X{constructor(t){super(),K(this,t,yt,xt,i,{shops:0})}}function kt(t){let e,n;const o=t[2].default,l=function(t,e,n,o){if(t){const l=r(t,e,n,o);return t[0](l)}}(o,t,t[1],null);return{c(){e=f("div"),l&&l.c(),v(e,"class","overlay svelte-1vngmk0")},m(t,o){u(t,e,o),l&&l.m(e,null),n=!0},p(t,e){l&&l.p&&(!n||2&e)&&function(t,e,n,o,l,i){if(l){const s=r(e,n,o,i);t.p(s,l)}}(l,o,t,t[1],n?function(t,e,n,o){if(t[2]&&o){const l=t[2](o(n));if(void 0===e.dirty)return l;if("object"==typeof l){const t=[],n=Math.max(e.dirty.length,l.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|l[o];return t}return e.dirty|l}return e.dirty}(o,t[1],e,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[1]),null)},i(t){n||(Q(l,t),n=!0)},o(t){H(l,t),n=!1},d(t){t&&d(e),l&&l.d(t)}}}function Dt(t){let e,n,o=t[0]&&kt(t);return{c(){o&&o.c(),e=m()},m(t,l){o&&o.m(t,l),u(t,e,l),n=!0},p(t,[n]){t[0]?o?(o.p(t,n),1&n&&Q(o,1)):(o=kt(t),o.c(),Q(o,1),o.m(e.parentNode,e)):o&&(B(),H(o,1,1,(()=>{o=null})),Z())},i(t){n||(Q(o),n=!0)},o(t){H(o),n=!1},d(t){o&&o.d(t),t&&d(e)}}}function Nt(t,e,n){let{$$slots:o={},$$scope:l}=e,{visible:i=!1}=e;return t.$$set=t=>{"visible"in t&&n(0,i=t.visible),"$$scope"in t&&n(1,l=t.$$scope)},[i,l,o]}class Tt extends X{constructor(t){super(),K(this,t,Nt,Dt,i,{visible:0})}}var Lt={text:t=>t.toString().trim().length>0,floatOverZero:t=>"number"==typeof t&&t>0};function jt(t){let e,n;return{c(){e=f("label"),n=$(t[2]),v(e,"for",t[4]),v(e,"class","svelte-1ioo2o9")},m(t,o){u(t,e,o),a(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&d(e)}}}function St(e){let n,l,i,s,r,p,$=""!==e[2]&&jt(e);return{c(){n=f("div"),$&&$.c(),l=h(),i=f("input"),v(i,"class",s=c(e[3])+" svelte-1ioo2o9"),v(i,"id",e[4]),v(i,"type","text"),v(i,"placeholder",e[1]),v(n,"class","container svelte-1ioo2o9")},m(t,o){u(t,n,o),$&&$.m(n,null),a(n,l),a(n,i),x(i,e[0]),r||(p=[g(i,"keyup",e[5]),g(i,"input",e[8])],r=!0)},p(t,[e]){""!==t[2]?$?$.p(t,e):($=jt(t),$.c(),$.m(n,l)):$&&($.d(1),$=null),8&e&&s!==(s=c(t[3])+" svelte-1ioo2o9")&&v(i,"class",s),2&e&&v(i,"placeholder",t[1]),1&e&&i.value!==t[0]&&x(i,t[0])},i:t,o:t,d(t){t&&d(n),$&&$.d(),r=!1,o(p)}}}function It(t,e,n){let o,{placeholder:l=""}=e,{value:i=""}=e,{label:s=""}=e;const r="id-"+Math.random().toString(36).substring(2,5);let c=!0,{validIf:a=(t=>!0)}=e;return t.$$set=t=>{"placeholder"in t&&n(1,l=t.placeholder),"value"in t&&n(0,i=t.value),"label"in t&&n(2,s=t.label),"validIf"in t&&n(6,a=t.validIf)},t.$$.update=()=>{128&t.$$.dirty&&n(3,o=c?"":"invalid")},[i,l,s,o,r,t=>{n(7,c=a(i))},a,c,function(){i=this.value,n(0,i)}]}class At extends X{constructor(t){super(),K(this,t,It,St,i,{placeholder:1,value:0,label:2,validIf:6})}}function Ct(t){let e,n;return{c(){e=f("label"),n=$(t[2]),v(e,"for",t[5]),v(e,"class","svelte-lo7ls3")},m(t,o){u(t,e,o),a(e,n)},p(t,e){4&e&&w(n,t[2])},d(t){t&&d(e)}}}function Ot(e){let n,l,i,s,r,p,$=""!==e[2]&&Ct(e);return{c(){n=f("div"),$&&$.c(),l=h(),i=f("input"),v(i,"class",s=c(e[4])+" svelte-lo7ls3"),v(i,"id",e[5]),v(i,"type","number"),v(i,"placeholder",e[1]),v(n,"class","container svelte-lo7ls3")},m(t,o){u(t,n,o),$&&$.m(n,null),a(n,l),a(n,i),e[9](i),x(i,e[0]),r||(p=[g(i,"keyup",e[6]),g(i,"input",e[10])],r=!0)},p(t,[e]){""!==t[2]?$?$.p(t,e):($=Ct(t),$.c(),$.m(n,l)):$&&($.d(1),$=null),16&e&&s!==(s=c(t[4])+" svelte-lo7ls3")&&v(i,"class",s),2&e&&v(i,"placeholder",t[1]),1&e&&M(i.value)!==t[0]&&x(i,t[0])},i:t,o:t,d(t){t&&d(n),$&&$.d(),e[9](null),r=!1,o(p)}}}function zt(t,e,n){let o,{placeholder:l=""}=e,{value:i=""}=e,{label:s=""}=e;const r="id-"+Math.random().toString(36).substring(2,5);let c=!0,{validIf:a=(t=>!0)}=e;let u;return D((()=>{u.addEventListener("wheel",(t=>{t.preventDefault()}))})),t.$$set=t=>{"placeholder"in t&&n(1,l=t.placeholder),"value"in t&&n(0,i=t.value),"label"in t&&n(2,s=t.label),"validIf"in t&&n(7,a=t.validIf)},t.$$.update=()=>{256&t.$$.dirty&&n(4,o=c?"":"invalid")},[i,l,s,u,o,r,t=>{n(8,c=a(null!=i?i:0))},a,c,function(t){S[t?"unshift":"push"]((()=>{u=t,n(3,u)}))},function(){i=M(this.value),n(0,i)}]}class Et extends X{constructor(t){super(),K(this,t,zt,Ot,i,{placeholder:1,value:0,label:2,validIf:7})}}function Ft(t){let e,n,o,l,i;return{c(){e=f("div"),n=f("div"),o=$(t[0]),v(n,"class","text svelte-lqqv5g"),v(e,"style",t[2]),v(e,"class","button svelte-lqqv5g")},m(s,r){u(s,e,r),a(e,n),a(n,o),l||(i=g(e,"click",t[6]),l=!0)},p(t,n){1&n&&w(o,t[0]),4&n&&v(e,"style",t[2])},d(t){t&&d(e),l=!1,i()}}}function Yt(t){let e,n,o;return{c(){e=f("div"),n=f("div"),o=$(t[0]),v(n,"class","text svelte-lqqv5g"),v(e,"style",t[2]),v(e,"class","button disabled svelte-lqqv5g")},m(t,l){u(t,e,l),a(e,n),a(n,o)},p(t,n){1&n&&w(o,t[0]),4&n&&v(e,"style",t[2])},d(t){t&&d(e)}}}function _t(e){let n;function o(t,e){return t[1]?Yt:Ft}let l=o(e),i=l(e);return{c(){n=f("div"),i.c(),v(n,"class","container svelte-lqqv5g")},m(t,e){u(t,n,e),i.m(n,null)},p(t,[e]){l===(l=o(t))&&i?i.p(t,e):(i.d(1),i=l(t),i&&(i.c(),i.m(n,null)))},i:t,o:t,d(t){t&&d(n),i.d()}}}function Pt(t,e,n){let o;const l=N();let{text:i="button"}=e,{disabled:s=!1}=e,{highlight:r}=e,c={};return t.$$set=t=>{"text"in t&&n(0,i=t.text),"disabled"in t&&n(1,s=t.disabled),"highlight"in t&&n(4,r=t.highlight)},t.$$.update=()=>{16&t.$$.dirty&&void 0!==r&&n(5,c["background-color"]=r,c),32&t.$$.dirty&&n(2,o=Object.entries(c).map((([t,e])=>`${t}:${e}`)).join(";"))},[i,s,o,l,r,c,t=>{l("click",t)}]}class Ut extends X{constructor(t){super(),K(this,t,Pt,_t,i,{text:0,disabled:1,highlight:4})}}function qt(t){let e,n,o,i,s,r,c,p,$,m,g,M,w,x,y;function b(e){t[7](e)}let k={label:"A flat white costs",placeholder:"1.23",validIf:Lt.floatOverZero};function D(e){t[8](e)}void 0!==t[1]&&(k.value=t[1]),n=new Et({props:k}),S.push((()=>G(n,"value",b)));let N={label:"At",placeholder:"shop name",validIf:Lt.text};function T(e){t[9](e)}void 0!==t[0]&&(N.value=t[0]),s=new At({props:N}),S.push((()=>G(s,"value",D)));let L={label:"Notes?",placeholder:"A nice coffee shop"};return void 0!==t[2]&&(L.value=t[2]),p=new At({props:L}),S.push((()=>G(p,"value",T))),M=new Ut({props:{text:"add",disabled:!t[5]}}),M.$on("click",(function(){l(t[3])&&t[3].apply(this,arguments)})),x=new Ut({props:{text:"cancel"}}),x.$on("click",(function(){l(t[4])&&t[4].apply(this,arguments)})),{c(){e=f("div"),W(n.$$.fragment),i=h(),W(s.$$.fragment),c=h(),W(p.$$.fragment),m=h(),g=f("div"),W(M.$$.fragment),w=h(),W(x.$$.fragment),v(g,"class","buttons svelte-1msqfqr"),v(e,"class","new-marker-prompt-container svelte-1msqfqr")},m(t,o){u(t,e,o),J(n,e,null),a(e,i),J(s,e,null),a(e,c),J(p,e,null),a(e,m),a(e,g),J(M,g,null),a(g,w),J(x,g,null),y=!0},p(e,[l]){t=e;const i={};!o&&2&l&&(o=!0,i.value=t[1],E((()=>o=!1))),n.$set(i);const c={};!r&&1&l&&(r=!0,c.value=t[0],E((()=>r=!1))),s.$set(c);const a={};!$&&4&l&&($=!0,a.value=t[2],E((()=>$=!1))),p.$set(a);const u={};32&l&&(u.disabled=!t[5]),M.$set(u)},i(t){y||(Q(n.$$.fragment,t),Q(s.$$.fragment,t),Q(p.$$.fragment,t),Q(M.$$.fragment,t),Q(x.$$.fragment,t),y=!0)},o(t){H(n.$$.fragment,t),H(s.$$.fragment,t),H(p.$$.fragment,t),H(M.$$.fragment,t),H(x.$$.fragment,t),y=!1},d(t){t&&d(e),R(n),R(s),R(p),R(M),R(x)}}}function Bt(t,e,n){let o,{newShopName:l=""}=e,{newShopDesc:i=""}=e,{newShopPrice:s=""}=e,{add:r}=e,{cancel:c}=e;const a=t=>{"Escape"===t.key&&c(t),"Enter"===t.key&&o&&r(t)};return D((()=>{document.addEventListener("keydown",a)})),t.$$set=t=>{"newShopName"in t&&n(0,l=t.newShopName),"newShopDesc"in t&&n(2,i=t.newShopDesc),"newShopPrice"in t&&n(1,s=t.newShopPrice),"add"in t&&n(3,r=t.add),"cancel"in t&&n(4,c=t.cancel)},t.$$.update=()=>{3&t.$$.dirty&&n(5,o=Lt.text(l)&&Lt.floatOverZero(parseFloat(null!==s?s.toString():"0")))},[l,s,i,r,c,o,()=>{n(0,l=""),n(2,i=""),n(1,s="")},function(t){s=t,n(1,s)},function(t){l=t,n(0,l)},function(t){i=t,n(2,i)}]}class Zt extends X{constructor(t){super(),K(this,t,Bt,qt,i,{newShopName:0,newShopDesc:2,newShopPrice:1,add:3,cancel:4,clearFields:6})}get clearFields(){return this.$$.ctx[6]}}function Qt(e){let n,o,l,i,s,r,c,p=e[0].lat.toFixed(4)+"",m=e[0].lng.toFixed(4)+"";return{c(){n=f("div"),o=f("div"),o.textContent="Home Location",l=h(),i=f("div"),s=$(p),r=$(", "),c=$(m),v(o,"class","title svelte-1oagpos"),v(i,"class","latlng svelte-1oagpos"),v(n,"class","container svelte-1oagpos")},m(t,e){u(t,n,e),a(n,o),a(n,l),a(n,i),a(i,s),a(i,r),a(i,c)},p(t,[e]){1&e&&p!==(p=t[0].lat.toFixed(4)+"")&&w(s,p),1&e&&m!==(m=t[0].lng.toFixed(4)+"")&&w(c,m)},i:t,o:t,d(t){t&&d(n)}}}function Ht(t,e,n){let o;return s(t,lt,(t=>n(0,o=t))),[o]}class Gt extends X{constructor(t){super(),K(this,t,Ht,Qt,i,{})}}function Wt(t){let e,n,o,l,i,s,r,c,p,$,m,g;const M=[Rt,Jt],w=[];function x(t,e){return t[1]?0:1}n=x(t),o=w[n]=M[n](t);const y=[Xt,Kt],b=[];function k(t,e){return t[1]?0:1}return s=k(t),r=b[s]=y[s](t),p=new Ut({props:{text:"Nav"}}),p.$on("click",t[6]),m=new Ut({props:{highlight:t[2]?"#ce6688":"white",text:t[2]?"confirm":"delete"}}),m.$on("click",t[5]),{c(){e=f("div"),o.c(),l=h(),i=f("div"),r.c(),c=h(),W(p.$$.fragment),$=h(),W(m.$$.fragment),v(i,"class","buttons svelte-4u5bf7"),v(e,"class","container wireframe svelte-4u5bf7")},m(t,o){u(t,e,o),w[n].m(e,null),a(e,l),a(e,i),b[s].m(i,null),a(i,c),J(p,i,null),a(i,$),J(m,i,null),g=!0},p(t,a){let u=n;n=x(t),n===u?w[n].p(t,a):(B(),H(w[u],1,1,(()=>{w[u]=null})),Z(),o=w[n],o?o.p(t,a):(o=w[n]=M[n](t),o.c()),Q(o,1),o.m(e,l));let d=s;s=k(t),s===d?b[s].p(t,a):(B(),H(b[d],1,1,(()=>{b[d]=null})),Z(),r=b[s],r?r.p(t,a):(r=b[s]=y[s](t),r.c()),Q(r,1),r.m(i,c));const p={};4&a&&(p.highlight=t[2]?"#ce6688":"white"),4&a&&(p.text=t[2]?"confirm":"delete"),m.$set(p)},i(t){g||(Q(o),Q(r),Q(p.$$.fragment,t),Q(m.$$.fragment,t),g=!0)},o(t){H(o),H(r),H(p.$$.fragment,t),H(m.$$.fragment,t),g=!1},d(t){t&&d(e),w[n].d(),b[s].d(),R(p),R(m)}}}function Jt(e){let n,o,l,i,s,r,c,p,m,g,M,x,y=e[0].name+"",b=e[0].location.lat.toFixed(4)+"",k=e[0].location.lng.toFixed(4)+"",D=e[0].price.toFixed(2)+"",N=e[0].description&&Vt(e);return{c(){n=f("div"),o=$(y),l=h(),i=f("div"),s=$(b),r=$(", "),c=$(k),p=h(),N&&N.c(),m=h(),g=f("div"),M=$("£"),x=$(D),v(n,"class","title-text"),v(i,"class","small-text"),v(g,"class","price-text")},m(t,e){u(t,n,e),a(n,o),u(t,l,e),u(t,i,e),a(i,s),a(i,r),a(i,c),u(t,p,e),N&&N.m(t,e),u(t,m,e),u(t,g,e),a(g,M),a(g,x)},p(t,e){1&e&&y!==(y=t[0].name+"")&&w(o,y),1&e&&b!==(b=t[0].location.lat.toFixed(4)+"")&&w(s,b),1&e&&k!==(k=t[0].location.lng.toFixed(4)+"")&&w(c,k),t[0].description?N?N.p(t,e):(N=Vt(t),N.c(),N.m(m.parentNode,m)):N&&(N.d(1),N=null),1&e&&D!==(D=t[0].price.toFixed(2)+"")&&w(x,D)},i:t,o:t,d(t){t&&d(n),t&&d(l),t&&d(i),t&&d(p),N&&N.d(t),t&&d(m),t&&d(g)}}}function Rt(t){let e,n,o,l,i,s,r,c,p,m,g,M,x,y,b=t[0].location.lat.toFixed(4)+"",k=t[0].location.lng.toFixed(4)+"";function D(e){t[7](e)}let N={placeholder:t[0].name??"shop name"};function T(e){t[8](e)}void 0!==t[0].name&&(N.value=t[0].name),e=new At({props:N}),S.push((()=>G(e,"value",D)));let L={placeholder:t[0].description.length?t[0].description:"description"};function j(e){t[9](e)}void 0!==t[0].description&&(L.value=t[0].description),p=new At({props:L}),S.push((()=>G(p,"value",T)));let I={placeholder:`£${t[0].price??0}`};return void 0!==t[0].price&&(I.value=t[0].price),M=new Et({props:I}),S.push((()=>G(M,"value",j))),{c(){W(e.$$.fragment),o=h(),l=f("div"),i=$(b),s=$(", "),r=$(k),c=h(),W(p.$$.fragment),g=h(),W(M.$$.fragment),v(l,"class","small-text")},m(t,n){J(e,t,n),u(t,o,n),u(t,l,n),a(l,i),a(l,s),a(l,r),u(t,c,n),J(p,t,n),u(t,g,n),J(M,t,n),y=!0},p(t,o){const l={};1&o&&(l.placeholder=t[0].name??"shop name"),!n&&1&o&&(n=!0,l.value=t[0].name,E((()=>n=!1))),e.$set(l),(!y||1&o)&&b!==(b=t[0].location.lat.toFixed(4)+"")&&w(i,b),(!y||1&o)&&k!==(k=t[0].location.lng.toFixed(4)+"")&&w(r,k);const s={};1&o&&(s.placeholder=t[0].description.length?t[0].description:"description"),!m&&1&o&&(m=!0,s.value=t[0].description,E((()=>m=!1))),p.$set(s);const c={};1&o&&(c.placeholder=`£${t[0].price??0}`),!x&&1&o&&(x=!0,c.value=t[0].price,E((()=>x=!1))),M.$set(c)},i(t){y||(Q(e.$$.fragment,t),Q(p.$$.fragment,t),Q(M.$$.fragment,t),y=!0)},o(t){H(e.$$.fragment,t),H(p.$$.fragment,t),H(M.$$.fragment,t),y=!1},d(t){R(e,t),t&&d(o),t&&d(l),t&&d(c),R(p,t),t&&d(g),R(M,t)}}}function Vt(t){let e,n,o=t[0].description+"";return{c(){e=f("div"),n=$(o),v(e,"class","desc-text")},m(t,o){u(t,e,o),a(e,n)},p(t,e){1&e&&o!==(o=t[0].description+"")&&w(n,o)},d(t){t&&d(e)}}}function Kt(e){let n,o;return n=new Ut({props:{text:"edit"}}),n.$on("click",e[3]),{c(){W(n.$$.fragment)},m(t,e){J(n,t,e),o=!0},p:t,i(t){o||(Q(n.$$.fragment,t),o=!0)},o(t){H(n.$$.fragment,t),o=!1},d(t){R(n,t)}}}function Xt(e){let n,o;return n=new Ut({props:{text:"save"}}),n.$on("click",e[4]),{c(){W(n.$$.fragment)},m(t,e){J(n,t,e),o=!0},p:t,i(t){o||(Q(n.$$.fragment,t),o=!0)},o(t){H(n.$$.fragment,t),o=!1},d(t){R(n,t)}}}function te(t){let e,n,o=void 0!==t[0]&&Wt(t);return{c(){o&&o.c(),e=m()},m(t,l){o&&o.m(t,l),u(t,e,l),n=!0},p(t,[n]){void 0!==t[0]?o?(o.p(t,n),1&n&&Q(o,1)):(o=Wt(t),o.c(),Q(o,1),o.m(e.parentNode,e)):o&&(B(),H(o,1,1,(()=>{o=null})),Z())},i(t){n||(Q(o),n=!0)},o(t){H(o),n=!1},d(t){o&&o.d(t),t&&d(e)}}}function ee(t,e,n){let o;s(t,it,(t=>n(10,o=t)));let{shop:l}=e;const i=N();let r=!1,c=!1;const a=t=>{n(1,r=void 0!==t?t:!r)},u=t=>{n(2,c=void 0!==t?t:!c)};return t.$$set=t=>{"shop"in t&&n(0,l=t.shop)},t.$$.update=()=>{1&t.$$.dirty&&void 0===l&&(a(!1),u(!1)),1&t.$$.dirty&&u(!1)},[l,r,c,()=>{a()},()=>{i("shopUpdated",l),a()},()=>{if(!c)return void u(!0);const t=o.filter((t=>!(t===l)));it.set(t),u(!1),n(0,l=void 0)},()=>{i("navigateToShop",l)},function(e){t.$$.not_equal(l.name,e)&&(l.name=e,n(0,l))},function(e){t.$$.not_equal(l.description,e)&&(l.description=e,n(0,l))},function(e){t.$$.not_equal(l.price,e)&&(l.price=e,n(0,l))}]}class ne extends X{constructor(t){super(),K(this,t,ee,te,i,{shop:0})}}class oe{constructor(t){this.json=t}getFeatures(){var t;return null!==(t=this.json.features)&&void 0!==t?t:[]}getAllSegments(){const t=[];return this.getFeatures().forEach((e=>{var n;e.properties&&e.properties.segments&&t.push(...null!==(n=e.properties.segments)&&void 0!==n?n:[])})),t}getAllSteps(){const t=[];return this.getAllSegments().forEach((e=>{var n;t.push(...null!==(n=e.steps)&&void 0!==n?n:[])})),t}}function le(t,e,n){const o=t.slice();return o[5]=e[n],o}function ie(t){let e,n,o,l,i,s,r,c=t[5].instruction+"",p=t[5].name+"";return{c(){e=f("div"),n=f("div"),o=$(c),l=h(),i=f("div"),s=$(p),r=h(),v(i,"class","small-text"),v(e,"class","step-container svelte-zekzf4")},m(t,c){u(t,e,c),a(e,n),a(n,o),a(e,l),a(e,i),a(i,s),a(e,r)},p(t,e){1&e&&c!==(c=t[5].instruction+"")&&w(o,c),1&e&&p!==(p=t[5].name+"")&&w(s,p)},d(t){t&&d(e)}}}function se(t){let e,n,o,l,i,s;l=new Ut({props:{text:"close"}}),l.$on("click",t[3]);let r=t[0],c=[];for(let e=0;e<r.length;e+=1)c[e]=ie(le(t,r,e));return{c(){e=f("div"),n=f("div"),o=f("div"),W(l.$$.fragment),i=h();for(let t=0;t<c.length;t+=1)c[t].c();v(o,"class","button svelte-zekzf4"),v(n,"class","button-container svelte-zekzf4"),v(e,"class","container svelte-zekzf4")},m(t,r){u(t,e,r),a(e,n),a(n,o),J(l,o,null),a(e,i);for(let t=0;t<c.length;t+=1)c[t].m(e,null);s=!0},p(t,[n]){if(1&n){let o;for(r=t[0],o=0;o<r.length;o+=1){const l=le(t,r,o);c[o]?c[o].p(l,n):(c[o]=ie(l),c[o].c(),c[o].m(e,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=r.length}},i(t){s||(Q(l.$$.fragment,t),s=!0)},o(t){H(l.$$.fragment,t),s=!1},d(t){t&&d(e),R(l),p(c,t)}}}function re(t,e,n){const o=N();let{directions:l}=e;let i=[];return t.$$set=t=>{"directions"in t&&n(2,l=t.directions)},t.$$.update=()=>{4&t.$$.dirty&&n(0,i=new oe(l).getAllSteps())},[i,o,l,()=>{o("close")}]}class ce extends X{constructor(t){super(),K(this,t,re,se,i,{directions:2})}}function ae(e){let n,o,l,i,s,r,c,p;return c=new Ut({props:{text:"Got it"}}),c.$on("click",e[1]),{c(){n=f("div"),o=f("div"),o.textContent="Coffee-near-me",l=h(),i=f("ul"),i.innerHTML="<li>Click on the map to add new shops.</li> \n    <li>Click the marker or the item on the list to edit.</li> \n    <li>Long-press on anywhere on the map to set your current location.</li>",s=h(),r=f("div"),W(c.$$.fragment),v(o,"class","title-text"),v(i,"class","list svelte-1b0x8lx"),v(r,"class","buttons"),v(n,"class","container wireframe svelte-1b0x8lx")},m(t,e){u(t,n,e),a(n,o),a(n,l),a(n,i),a(n,s),a(n,r),J(c,r,null),p=!0},p:t,i(t){p||(Q(c.$$.fragment,t),p=!0)},o(t){H(c.$$.fragment,t),p=!1},d(t){t&&d(n),R(c)}}}function ue(t){const e=N();return[e,()=>{e("close")}]}class de extends X{constructor(t){super(),K(this,t,ue,ae,i,{})}}const pe=ot({});function fe(t){let e,n,o,l,i;function s(e){t[20](e)}function r(e){t[21](e)}function c(e){t[22](e)}let a={add:t[13],cancel:t[14]};return void 0!==t[4]&&(a.newShopName=t[4]),void 0!==t[5]&&(a.newShopDesc=t[5]),void 0!==t[6]&&(a.newShopPrice=t[6]),e=new Zt({props:a}),t[19](e),S.push((()=>G(e,"newShopName",s))),S.push((()=>G(e,"newShopDesc",r))),S.push((()=>G(e,"newShopPrice",c))),{c(){W(e.$$.fragment)},m(t,n){J(e,t,n),i=!0},p(t,i){const s={};!n&&16&i[0]&&(n=!0,s.newShopName=t[4],E((()=>n=!1))),!o&&32&i[0]&&(o=!0,s.newShopDesc=t[5],E((()=>o=!1))),!l&&64&i[0]&&(l=!0,s.newShopPrice=t[6],E((()=>l=!1))),e.$set(s)},i(t){i||(Q(e.$$.fragment,t),i=!0)},o(t){H(e.$$.fragment,t),i=!1},d(n){t[19](null),R(e,n)}}}function $e(e){let n,o;return n=new de({}),n.$on("close",e[23]),{c(){W(n.$$.fragment)},m(t,e){J(n,t,e),o=!0},p:t,i(t){o||(Q(n.$$.fragment,t),o=!0)},o(t){H(n.$$.fragment,t),o=!1},d(t){R(n,t)}}}function he(t){let e,n;return e=new ce({props:{directions:t[8]}}),e.$on("close",t[25]),{c(){W(e.$$.fragment)},m(t,o){J(e,t,o),n=!0},p(t,n){const o={};256&n[0]&&(o.directions=t[8]),e.$set(o)},i(t){n||(Q(e.$$.fragment,t),n=!0)},o(t){H(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function me(t){let e,n,o,l,i,s,r,c,p,$,m,g,M,w,x,y,b;n=new Tt({props:{visible:t[2],$$slots:{default:[fe]},$$scope:{ctx:t}}}),l=new Tt({props:{visible:t[1],$$slots:{default:[$e]},$$scope:{ctx:t}}}),r=new Gt({}),$=new bt({props:{shops:t[10]}}),$.$on("shopClick",t[16]),g=new ne({props:{shop:t[7]}}),g.$on("shopUpdated",t[17]),g.$on("navigateToShop",t[18]);x=new $t({props:{}}),t[24](x),x.$on("mapClick",t[12]),x.$on("mapLongPress",t[11]),x.$on("markerClick",t[15]);let k=t[9]&&t[8]&&he(t);return{c(){e=f("main"),W(n.$$.fragment),o=h(),W(l.$$.fragment),i=h(),s=f("div"),W(r.$$.fragment),c=h(),p=f("div"),W($.$$.fragment),m=h(),W(g.$$.fragment),M=h(),w=f("div"),W(x.$$.fragment),y=h(),k&&k.c(),v(p,"class","list-container svelte-bu5kqh"),v(s,"class","left svelte-bu5kqh"),v(w,"class","right svelte-bu5kqh"),v(e,"class","svelte-bu5kqh")},m(t,d){u(t,e,d),J(n,e,null),a(e,o),J(l,e,null),a(e,i),a(e,s),J(r,s,null),a(s,c),a(s,p),J($,p,null),a(s,m),J(g,s,null),a(e,M),a(e,w),J(x,w,null),a(w,y),k&&k.m(w,null),b=!0},p(t,e){const o={};4&e[0]&&(o.visible=t[2]),120&e[0]|1024&e[1]&&(o.$$scope={dirty:e,ctx:t}),n.$set(o);const i={};2&e[0]&&(i.visible=t[1]),1024&e[1]&&(i.$$scope={dirty:e,ctx:t}),l.$set(i);const s={};1024&e[0]&&(s.shops=t[10]),$.$set(s);const r={};128&e[0]&&(r.shop=t[7]),g.$set(r);x.$set({}),t[9]&&t[8]?k?(k.p(t,e),768&e[0]&&Q(k,1)):(k=he(t),k.c(),Q(k,1),k.m(w,null)):k&&(B(),H(k,1,1,(()=>{k=null})),Z())},i(t){b||(Q(n.$$.fragment,t),Q(l.$$.fragment,t),Q(r.$$.fragment,t),Q($.$$.fragment,t),Q(g.$$.fragment,t),Q(x.$$.fragment,t),Q(k),b=!0)},o(t){H(n.$$.fragment,t),H(l.$$.fragment,t),H(r.$$.fragment,t),H($.$$.fragment,t),H(g.$$.fragment,t),H(x.$$.fragment,t),H(k),b=!1},d(o){o&&d(e),R(n),R(l),R(r),R($),R(g),t[24](null),R(x),k&&k.d()}}}function ge(t,e,n){let o,l,i;s(t,lt,(t=>n(29,o=t))),s(t,pe,(t=>n(30,l=t))),s(t,it,(t=>n(10,i=t)));const{getWalkingDirections:r}=tt,{save:c,load:a}=et;let u,d,p,f,$,h,m=!1,g={lat:0,lng:0};let v=!1;let M;let w,x=!1;const y=t=>{const e=t.features,n=[];e.forEach((t=>{const{geometry:e}=t,{coordinates:o}=e;o.forEach((([t,e])=>{n.push([e,t])}))})),u.drawRoute(n)};let b;const k=(t,e)=>{b&&clearTimeout(b),b=setTimeout((()=>{c(t,e)}),2500)};it.subscribe((t=>{k("$ShopStore",t)})),lt.subscribe((t=>{k("$HomeLocation",t)})),pe.subscribe((t=>{k("$MemoisedDirections",t)})),st.subscribe((t=>{k("$SplashOverlayVisible",t),n(1,d=t)})),D((()=>{(()=>{if(!window.localStorage)throw new Error("loadSavedData called before window.localStorage is available");const t=a("$ShopStore"),e=a("$HomeLocation"),n=a("$SplashOverlayVisible"),o=a("$MemoisedDirections");null!==t&&"object"==typeof t&&it.set(t),null!==e&&"object"==typeof e&&lt.set(e),null!==n&&"boolean"==typeof n&&st.set(n),null!==o&&"object"==typeof o&&st.set(o)})()}));return[u,d,m,p,f,$,h,M,w,x,i,t=>{const e=t.detail;v=!0,confirm("Set this location as home?")&&(t=>{const{lat:e,lng:n}=t.latlng;lt.set({lat:e,lng:n})})(e)},t=>{if(v)return void(v=!1);const e=t.detail;g={lat:e.latlng.lat,lng:e.latlng.lng},n(2,m=!0)},t=>{(()=>{const t=i;t.push({name:f,description:$,price:h,location:g}),it.set(t)})(),p.clearFields(),n(2,m=!1)},t=>{n(2,m=!1)},t=>{let e=t.detail,{latlng:o}=e;u.flyTo({lat:o.lat,lng:o.lng});let l,s=`${o.lat}-${o.lng}`;i.forEach((t=>{`${t.location.lat}-${t.location.lng}`===s&&(l=t)})),n(7,M=l===M?void 0:l)},t=>{const e=t.detail;u.flyTo(e.location),n(7,M=e===M?void 0:e)},t=>{t.detail,it.set(i)},async t=>{const e=t.detail,i=o,s=e.location;let c;const a=`${i.lat},${i.lng}:${s.lat},${s.lng}`;c=(t=>{if(!Object.keys(l).includes(t))return;const e=l[t];if((new Date).valueOf()-e.added<432e6)return e.json;pe.update((e=>(delete e[t],e)))})(a),c||(c=await r(i,s),pe.update((t=>(t[a]={added:(new Date).valueOf(),json:c},t)))),y(c),n(8,w=c),n(9,x=!0)},function(t){S[t?"unshift":"push"]((()=>{p=t,n(3,p)}))},function(t){f=t,n(4,f)},function(t){$=t,n(5,$)},function(t){h=t,n(6,h)},()=>{st.set(!1)},function(t){S[t?"unshift":"push"]((()=>{u=t,n(0,u)}))},()=>{n(9,x=!1)}]}return new class extends X{constructor(t){super(),K(this,t,ge,me,i,{},null,[-1,-1])}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
